<style>
  .section-{{ section.id }}.custom-marquee {
    display: flex;
    align-items: center;
    height: {{ section.settings.marquee_height }}px;
    width: 100%;
    overflow: hidden;
    background: transparent;
    position: relative;
    margin: {{ section.settings.margin_top }}px 0 {{ section.settings.margin_bottom }}px 0;
  }

  .section-{{ section.id }}.custom-marquee .track {
    display: flex;
    align-items: center;
    position: absolute;
    will-change: transform;
    animation: marquee-{{ section.id }} {{ section.settings.speed }}s linear infinite;
  }

  .section-{{ section.id }}.custom-marquee .logo-item {
    margin: 0 {{ section.settings.spacing }}px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .section-{{ section.id }}.custom-marquee .logo-image {
    height: {{ section.settings.logo_height }}px;
    width: auto;
    max-width: {{ section.settings.logo_max_width }}px;
    object-fit: contain;
    transition: transform 0.3s ease;
    filter: brightness({{ section.settings.logo_brightness }}%);
  }

  .section-{{ section.id }}.custom-marquee .logo-image:hover {
    transform: scale({{ section.settings.hover_scale }});
  }

  @keyframes marquee-{{ section.id }} {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  @media (max-width: 767px) {
    .section-{{ section.id }}.custom-marquee {
      height: {{ section.settings.marquee_height_mobile }}px;
      margin: {{ section.settings.margin_top_mobile }}px 0 {{ section.settings.margin_bottom_mobile }}px 0;
    }
    .section-{{ section.id }}.custom-marquee .logo-image {
      height: {{ section.settings.logo_height_mobile }}px;
      max-width: {{ section.settings.logo_max_width_mobile }}px;
    }
    .section-{{ section.id }}.custom-marquee .logo-item {
      margin: 0 {{ section.settings.spacing_mobile }}px;
    }
  }
</style>

<div class="section-{{ section.id }} custom-marquee" role="region" aria-label="Logo marquee">
  <div class="track">
    {%- for i in (1..2) -%}
      {%- for block in section.blocks -%}
        <div class="logo-item" {{ block.shopify_attributes }}>
          {%- if block.settings.link != blank -%}
            <a href="{{ block.settings.link }}" aria-label="{{ block.settings.image.alt | default: 'Logo link' }}">
          {%- endif -%}
          
          {%- if block.settings.image != blank -%}
            <img src="{{ block.settings.image | img_url: '300x' }}" 
                 alt="{{ block.settings.image.alt | escape }}" 
                 class="logo-image"
                 loading="lazy"
                 width="{{ block.settings.image.width }}"
                 height="{{ block.settings.image.height }}">
          {%- else -%}
            <div class="logo-image" style="width: {{ section.settings.logo_max_width }}px; height: {{ section.settings.logo_height }}px; background: #f5f5f5; display: flex; align-items: center; justify-content: center;">
              {{ 'logo' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {%- endif -%}
          
          {%- if block.settings.link != blank -%}
            </a>
          {%- endif -%}
        </div>
      {%- endfor -%}
    {%- endfor -%}
  </div>
</div>

{% schema %}
{
  "name": "Logo Marquee",
  "settings": [
    {
      "type": "header",
      "content": "Desktop Settings"
    },
    {
      "type": "range",
      "id": "marquee_height",
      "min": 20,
      "max": 200,
      "step": 5,
      "default": 80,
      "label": "Marquee Height",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "logo_height",
      "min": 20,
      "max": 200,
      "step": 5,
      "default": 60,
      "label": "Logo Height",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "logo_max_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 150,
      "label": "Max Logo Width",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "spacing",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40,
      "label": "Spacing Between Logos",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "speed",
      "min": 5,
      "max": 60,
      "step": 1,
      "default": 20,
      "label": "Animation Speed",
      "unit": "sec"
    },
    {
      "type": "range",
      "id": "logo_brightness",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 100,
      "label": "Logo Brightness",
      "unit": "%"
    },
    {
      "type": "range",
      "id": "hover_scale",
      "min": 1,
      "max": 15,
      "step": 1,
      "default": 11,
      "label": "Hover Scale Effect (1.1 = 10% larger)",
      "info": "Value is divided by 10 (11 = 1.1x scale)"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 0,
      "label": "Top Margin",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 0,
      "label": "Bottom Margin",
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "range",
      "id": "marquee_height_mobile",
      "min": 20,
      "max": 150,
      "step": 5,
      "default": 60,
      "label": "Marquee Height",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "logo_height_mobile",
      "min": 15,
      "max": 150,
      "step": 5,
      "default": 40,
      "label": "Logo Height",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "logo_max_width_mobile",
      "min": 30,
      "max": 200,
      "step": 5,
      "default": 100,
      "label": "Max Logo Width",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "spacing_mobile",
      "min": 0,
      "max": 60,
      "step": 5,
      "default": 20,
      "label": "Spacing Between Logos",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_top_mobile",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 0,
      "label": "Top Margin",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 0,
      "label": "Bottom Margin",
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Logo Image",
          "info": "Recommended size: 300x300px"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Logo Link (optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Logo Marquee",
      "blocks": [
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        }
      ]
    }
  ],
  "enabled_on": {
    "groups": ["header", "footer", "aside"]
  }
}
{% endschema %}