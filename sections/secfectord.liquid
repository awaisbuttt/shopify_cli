<style>
  .product-grid-showcase {
    padding: {{ section.settings.section_padding_top | default: 40 }}px 0 {{ section.settings.section_padding_bottom | default: 40 }}px;
    background-color: {{ section.settings.background_color | default: '#ffffff' }};
  }
  
  .product-grid-showcase__wrapper {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }
  
  .product-grid-showcase__header {
    text-align: center;
    margin-bottom: 32px;
  }
  
  .product-grid-showcase__title {
    font-size: {{ section.settings.heading_size | default: 28 }}px;
    font-weight: bold;
    color: {{ section.settings.heading_color | default: '#000000' }};
    margin: 0 0 16px 0;
  }
  
  .product-grid-showcase__subtitle {
    font-size: 16px;
    color: #666666;
    margin: 0;
  }
  
  .product-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
  }
  
  .product-card {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    position: relative;
    border: 1px solid #f0f0f0;
    transition: border-color 0.2s ease, transform 0.2s ease;
    display: block;
    text-decoration: none;
    color: inherit;
  }
  
  .product-card:hover {
    border-color: #000000;
    transform: translateY(-2px);
    text-decoration: none;
    color: inherit;
  }
  
  .product-card__image-container {
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    overflow: hidden;
    background-color: #f8f8f8;
  }
  
  .product-card__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }
  
  .product-card:hover .product-card__image {
    transform: scale(1.05);
  }
  
  .product-card__badge {
    position: absolute;
    top: 8px;
    left: 8px;
    background-color: {{ section.settings.badge_bg_color | default: '#dc2626' }};
    color: white;
    padding: 4px 8px;
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
    border-radius: 3px;
    z-index: 2;
  }
  
  .product-card__content {
    padding: 16px;
  }
  
  .product-card__category {
    font-size: 12px;
    color: #666666;
    margin: 0 0 4px 0;
    text-transform: uppercase;
  }
  
  .product-card__title {
    font-size: 14px;
    font-weight: 500;
    color: #333333;
    margin: 0 0 8px 0;
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color 0.2s ease;
  }
  
  .product-card:hover .product-card__title {
    color: #000000;
  }
  
  .product-card__price {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
  }
  
  .product-card__current-price {
    font-size: 16px;
    font-weight: bold;
    color: {{ section.settings.price_color | default: '#000000' }};
  }
  
  .product-card__original-price {
    font-size: 14px;
    color: #999999;
    text-decoration: line-through;
  }
  
  .product-card__sale-price {
    color: {{ section.settings.sale_price_color | default: '#dc2626' }};
  }
  
  .product-card__colors {
    display: flex;
    gap: 6px;
    align-items: center;
    margin-bottom: 12px;
  }
  
  .color-swatch {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 1px solid #e0e0e0;
    cursor: pointer;
  }
  
  .color-count {
    font-size: 12px;
    color: #666666;
    margin-left: 4px;
  }
  
  .quantity-controls {
    display: flex;
    align-items: center;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    width: fit-content;
    position: relative;
    z-index: 10;
  }
  
  .quantity-btn {
    background: none;
    border: none;
    padding: 6px 10px;
    cursor: pointer;
    font-size: 14px;
    color: #666666;
    transition: background-color 0.2s ease;
  }
  
  .quantity-btn:hover {
    background-color: #f5f5f5;
  }
  
  .quantity-input {
    border: none;
    text-align: center;
    width: 40px;
    padding: 6px 4px;
    font-size: 14px;
  }
  
  /* Promotional Banner */
  .promo-banner {
    grid-column: span 1;
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    color: white;
    padding: 24px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    min-height: 280px;
  }
  
  .promo-banner__text {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 8px;
  }
  
  .promo-banner__subtext {
    font-size: 14px;
    opacity: 0.9;
  }
  
  /* Mobile Responsive */
  @media screen and (max-width: 1400px) {
    .product-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }
  
  @media screen and (max-width: 1024px) {
    .product-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
  }
  
  @media screen and (max-width: 768px) {
    .product-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .product-grid-showcase__wrapper {
      padding: 0 16px;
    }
    
    .product-card__content {
      padding: 12px;
    }
    
    .promo-banner {
      grid-column: span 2;
      min-height: 200px;
      padding: 20px;
    }
    
    .promo-banner__text {
      font-size: 20px;
    }
  }
  
  @media screen and (max-width: 480px) {
    .product-grid {
      grid-template-columns: 1fr;
    }
    
    .promo-banner {
      grid-column: span 1;
    }
  }
</style>

<section class="product-grid-showcase" id="section-{{ section.id }}">
  <div class="product-grid-showcase__wrapper">
    {% if section.settings.heading != blank %}
      <div class="product-grid-showcase__header">
        <h2 class="product-grid-showcase__title">{{ section.settings.heading }}</h2>
        {% if section.settings.subtitle != blank %}
          <p class="product-grid-showcase__subtitle">{{ section.settings.subtitle }}</p>
        {% endif %}
      </div>
    {% endif %}
    
    <div class="product-grid">
      {% if section.settings.collection != blank %}
        {% assign collection = collections[section.settings.collection] %}
        {% assign product_count = 0 %}
        
        {% for product in collection.products limit: section.settings.products_to_show %}
          {% assign product_count = product_count | plus: 1 %}
          
          <!-- Insert promo banner after specific product -->
          {% if product_count == section.settings.promo_position and section.settings.show_promo %}
            <div class="promo-banner">
              <div class="promo-banner__text">{{ section.settings.promo_text | default: 'UP TO 30% OFF' }}</div>
              <div class="promo-banner__subtext">{{ section.settings.promo_subtext | default: 'Selected Items' }}</div>
            </div>
          {% endif %}
          
          <a href="{{ product.url }}" class="product-card">
            <div class="product-card__image-container">
              {% if product.featured_image %}
                <img 
                  src="{{ product.featured_image | img_url: '400x400', crop: 'center' }}" 
                  alt="{{ product.title | escape }}"
                  class="product-card__image"
                  loading="lazy"
                >
              {% else %}
                <div style="background-color: #f3f4f6; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #9ca3af;">
                  No Image
                </div>
              {% endif %}
              
              {% if product.compare_at_price > product.price %}
                <div class="product-card__badge">{{ section.settings.sale_badge_text | default: 'SALE' }}</div>
              {% endif %}
            </div>
            
            <div class="product-card__content">
              <p class="product-card__category">{{ product.type | default: 'Kids Shoes' }}</p>
              <h3 class="product-card__title">{{ product.title }}</h3>
              
              <div class="product-card__price">
                {% if product.compare_at_price > product.price %}
                  <span class="product-card__current-price product-card__sale-price">{{ product.price | money }}</span>
                  <span class="product-card__original-price">{{ product.compare_at_price | money }}</span>
                {% else %}
                  <span class="product-card__current-price">{{ product.price | money }}</span>
                {% endif %}
              </div>
              
              {% if product.variants.size > 1 %}
                <div class="product-card__colors">
                  {% assign color_count = 0 %}
                  {% for variant in product.variants limit: 4 %}
                    {% assign color_count = color_count | plus: 1 %}
                    {% assign color_name = variant.option1 | downcase %}
                    {% assign color_hex = '#cccccc' %}
                    
                    {% case color_name %}
                      {% when 'black' %}
                        {% assign color_hex = '#000000' %}
                      {% when 'white' %}
                        {% assign color_hex = '#ffffff' %}
                      {% when 'red' %}
                        {% assign color_hex = '#dc2626' %}
                      {% when 'blue' %}
                        {% assign color_hex = '#2563eb' %}
                      {% when 'green' %}
                        {% assign color_hex = '#16a34a' %}
                      {% when 'gray' or 'grey' %}
                        {% assign color_hex = '#6b7280' %}
                      {% when 'navy' %}
                        {% assign color_hex = '#1e3a8a' %}
                    {% endcase %}
                    
                    <div class="color-swatch" style="background-color: {{ color_hex }};"></div>
                  {% endfor %}
                  
                  {% if product.variants.size > 4 %}
                    <span class="color-count">+{{ product.variants.size | minus: 4 }}</span>
                  {% endif %}
                </div>
              {% endif %}
              
              <div class="quantity-controls" onclick="event.preventDefault(); event.stopPropagation();">
                <button class="quantity-btn" onclick="decreaseQuantity({{ product.id }})">-</button>
                <input type="number" class="quantity-input" id="qty-{{ product.id }}" value="0" min="0" readonly>
                <button class="quantity-btn" onclick="increaseQuantity({{ product.id }})">+</button>
              </div>
            </div>
          </a>
        {% endfor %}
      {% else %}
        <!-- Default products for preview -->
        {% for i in (1..12) %}
          {% if i == 3 and section.settings.show_promo %}
            <div class="promo-banner">
              <div class="promo-banner__text">UP TO 30% OFF</div>
              <div class="promo-banner__subtext">Selected Items</div>
            </div>
          {% endif %}
          
          <a href="/products/sample-product-{{ i }}" class="product-card">
            <div class="product-card__image-container">
              <div style="background-color: #f3f4f6; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #9ca3af;">
                Product {{ i }}
              </div>
              {% if i == 1 or i == 5 %}
                <div class="product-card__badge">SALE</div>
              {% endif %}
            </div>
            
            <div class="product-card__content">
              <p class="product-card__category">Kids Shoes</p>
              <h3 class="product-card__title">Sample Product {{ i }}</h3>
              
              <div class="product-card__price">
                {% if i == 1 or i == 5 %}
                  <span class="product-card__current-price product-card__sale-price">Rs {{ 5900 | plus: i | times: 100 | divided_by: 100 }}.00 PKR</span>
                  <span class="product-card__original-price">Rs {{ 8900 | plus: i | times: 100 | divided_by: 100 }}.00 PKR</span>
                {% else %}
                  <span class="product-card__current-price">Rs {{ 7900 | plus: i | times: 100 | divided_by: 100 }}.00 PKR</span>
                {% endif %}
              </div>
              
              <div class="product-card__colors">
                <div class="color-swatch" style="background-color: #000000;"></div>
                <div class="color-swatch" style="background-color: #ffffff; border-color: #ccc;"></div>
                <div class="color-swatch" style="background-color: #dc2626;"></div>
                <span class="color-count">+2</span>
              </div>
              
              <div class="quantity-controls" onclick="event.preventDefault(); event.stopPropagation();">
                <button class="quantity-btn" onclick="decreaseQuantity({{ i }})">-</button>
                <input type="number" class="quantity-input" id="qty-{{ i }}" value="0" min="0" readonly>
                <button class="quantity-btn" onclick="increaseQuantity({{ i }})">+</button>
              </div>
            </div>
          </a>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</section>

<script>
  function increaseQuantity(productId) {
    const input = document.getElementById('qty-' + productId);
    const currentValue = parseInt(input.value) || 0;
    input.value = currentValue + 1;
  }
  
  function decreaseQuantity(productId) {
    const input = document.getElementById('qty-' + productId);
    const currentValue = parseInt(input.value) || 0;
    if (currentValue > 0) {
      input.value = currentValue - 1;
    }
  }
</script>

{% schema %}
{
  "name": "Product Grid Showcase",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 4,
      "max": 20,
      "step": 1,
      "default": 12,
      "label": "Products to show"
    },
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle"
    },
    {
      "type": "number",
      "id": "heading_size",
      "label": "Heading size",
      "default": 28
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Promotional Banner"
    },
    {
      "type": "checkbox",
      "id": "show_promo",
      "label": "Show promotional banner",
      "default": true
    },
    {
      "type": "range",
      "id": "promo_position",
      "min": 2,
      "max": 8,
      "step": 1,
      "default": 3,
      "label": "Banner position (after product number)"
    },
    {
      "type": "text",
      "id": "promo_text",
      "label": "Promotional text",
      "default": "UP TO 30% OFF"
    },
    {
      "type": "text",
      "id": "promo_subtext",
      "label": "Promotional subtext",
      "default": "Selected Items"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Price color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "sale_price_color",
      "label": "Sale price color",
      "default": "#dc2626"
    },
    {
      "type": "color",
      "id": "badge_bg_color",
      "label": "Sale badge color",
      "default": "#dc2626"
    },
    {
      "type": "text",
      "id": "sale_badge_text",
      "label": "Sale badge text",
      "default": "SALE"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 40,
      "label": "Top padding"
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 40,
      "label": "Bottom padding"
    }
  ],
  "presets": [
    {
      "name": "Product Grid Showcase",
      "settings": {
        "heading": "Featured Products",
        "products_to_show": 12,
        "show_promo": true,
        "promo_position": 3
      }
    }
  ]
}
{% endschema %}